<!DOCTYPE>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport"
        content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <title>{{ app.name }}</title>
    <link href="/static/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/static/fontawesome/css/all.min.css" rel="stylesheet">
    <link href="/static/css/default.css" rel="stylesheet">

    <link rel="icon" type="image/png" href="/static/img/icon.png" rel="shortcut icon">
    <link rel="apple-touch-icon" href="/static/img/icon.png">
    <link rel="manifest" href="/apps/{{app.id}}/manifest.webmanifest">

    <script defer src="/static/js/wpa.babf8948.laozy-f3af4baa5afb88263207.js"></script>

    <script defer>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('/apps/{{app.id}}/sw.js', {
                    scope: "/apps/{{app.id}}/"
                }).then(function (registration) {
                    console.log('register sw.js success: ', registration.scope);
                }).catch(function (err) {
                    console.log('register sw.js failed: ', err);
                });
            });
        };
    </script>
</head>

<body style="height: 100vh;">
    <!--<div class="text-center fw-bold p-3 bg-light" style="height: 50px;">{{ app.name }}</div>-->
    <div id="chat"></div>
    <script defer>
        window.onload = function () {
            var docHeight = document.documentElement.clientHeight;
            docHeight = docHeight == 0 ? 99999 : docHeight;

            var height = window.screen.availHeight;
            height = height < docHeight ? height : docHeight;
            //height -= 50;

            laozy.chat.createChat('chat', connector_id = '{{app.id}}', height = height);
            laozy.accounts.autoRefreshToken();
        }
    </script>
</body>

</html>